!function(a,b,c,d,e){a.GuessWhere=a.GuessWhere||e(a,b,c,d),c(b).ready(GuessWhere.init)}(this,document,jQuery,google,function(a,b,c,d){"use strict";var e={},f={fbscopes:"email",iOS:new RegExp(/iP(od|ad|hone)/).test(navigator.userAgent),android:new RegExp(/(Android)/).test(navigator.userAgent)},g=function(b,f,g,h){var i=e.map=new d.maps.Map(e.canvas,{center:new d.maps.LatLng(b||45.436,f||4.876),zoom:g||2,backgroundColor:"#f1f1f1",disableDefaultUI:!0,disableDoubleClickZoom:!0,keyboardShortcuts:!1,scrollwheel:!1,draggable:!1,styles:[{featureType:"administrative.country",elementType:"geometry.stroke",stylers:[{visibility:"off"}]},{featureType:"administrative",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"transit.station",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"landscape",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road.highway",elementType:"labels.text.fill",stylers:[{visibility:"simplified"}]},{featureType:"water",stylers:[{visibility:"on"},{color:"#5fbcec"}]},{featureType:"road",stylers:[{lightness:10},{saturation:-40}]},{featureType:"landscape",stylers:[{color:"#f2f2f2"},{visibility:"on"}]}]});d.maps.event.addListenerOnce(i,"tilesloaded",function(){return!(!h||"function"!=typeof h)&&h.call(this,i)}),c(a).on("resize",function(a){d.maps.event.trigger(e.map,"resize")})},h=function(a,b,d,e){return c.ajax({url:a,type:"GET",dataType:"JSON",data:b,success:d,error:e})},i=function(){e.canvas=c("#mapCanvas").get(0),e.geocoder=new d.maps.Geocoder,g(45.436,4.876,2,function(a){h("./assets/js/countries.json",{},j,function(a,b){})}),c(".fa-info-circle").on("click",function(a){alert("By continue to use this website, you agree to use of cookies.")})},j=function(a){var b={total:a.length,countries:[],capitals:[],byRegion:{},bySubregion:{}};return c.map(a,function(a){a.capital&&""!==a.capital&&(b.capitals.push(a.capital),b.countries.push({name:a.name.official,latlng:new d.maps.LatLng(a.latlng[0],a.latlng[1]),capital:a.capital}),b.byRegion[a.region]=b.byRegion[a.region]||[],b.byRegion[a.region].push({name:a.name.official,latlng:new d.maps.LatLng(a.latlng[0],a.latlng[1]),capital:a.capital}),b.bySubregion[a.subregion]=b.bySubregion[a.subregion]||[],b.bySubregion[a.subregion].push({name:a.name.official,latlng:new d.maps.LatLng(a.latlng[0],a.latlng[1]),capital:a.capital}))}),e.data=b,k(),m()},k=function(){var a=c(".regions"),b=c(".toggle-regions");for(var d in e.data.byRegion)""!=d&&c("<li />").append(c("<label />",{html:" "+d}).prepend(c("<input />",{type:"radio",name:"region",value:d.toLowerCase(),id:"region"+d.replace(" ",""),"data-title":d}).on("click",l))).appendTo(a);b.on("click",function(c){c.preventDefault(),a.toggleClass("regions--open"),b.find(".fa").toggleClass("fa-plus fa-minus")}),c("#regionWorld").click(l)},l=function(a){this.checked&&(e.quiz.region=c(this).data("title"))},m=function(){e.quiz=e.quiz||{},e.quiz.done=e.quiz.done||[],e.quiz.correct=e.quiz.correct||0,e.quiz.answer=e.quiz.answer||"",e.quiz.region=e.quiz.region||"World";var a=o();if(void 0===a||!a.capital||""===a.capital)return m();e.geocoder.geocode({address:a.capital},function(b,g){if(g===d.maps.GeocoderStatus.OK){var h=b[0];e.map.panTo(h.geometry.location),e.map.setZoom(f.iOS||f.android?10:12),f.iOS||f.android?e.map.panBy(0,-100):e.map.panBy(-100,0);var i=c(".guesses").empty(),j=[];j.push(c("<button />",{class:"btn the-guess btn-info animated",type:"button",html:a.capital})),e.quiz.answer=a.capital,e.quiz.done.push(a);for(var k=0;k<3;k++){var l=o();void 0!==l&&l.capital?j.push(c("<button />",{class:"btn the-guess btn-info animated",type:"button",html:l.capital})):k--}j=p(j),c(j).each(function(a,b){c(b).delay(100*a).promise().done(function(){c(this).appendTo(i).addClass("fadeInLeft").on("click",n)})}),c(".score-out-of").html(e.quiz.done.length)}})},n=function(b){b.preventDefault();var d=c(this).prop("disabled",!0),f=d.html();f===e.quiz.answer?(e.quiz.correct+=1,d.toggleClass("btn-info btn-success").html('<i class="fa fa-check"></i> '+f)):(d.toggleClass("btn-info btn-danger").html('<i class="fa fa-remove"></i> '+f),d.siblings(".the-guess").each(function(a,b){var d=c(b),f=d.html();f===e.quiz.answer&&d.toggleClass("btn-info btn-success").html('<i class="fa fa-check"></i> '+f)})),d.siblings().prop("disabled",!0),c(".scored").html(e.quiz.correct),c(".score-out-of").html(e.quiz.done.length),a.setTimeout(function(){c(".animated").each(function(a,b){c(b).addClass("fadeOutRight")}),m()},1500)},o=function(){var a="World"===e.quiz.region?e.data.countries[Math.floor(Math.random()*e.data.countries.length)]:e.data.byRegion[e.quiz.region][Math.floor(Math.random()*e.data.byRegion[e.quiz.region].length)];if(e.quiz&&e.quiz.done&&-1===e.quiz.done.indexOf(a))return a;o()},p=function(a){for(var b,c,d=a.length;d>0;)c=Math.floor(Math.random()*d),d--,b=a[d],a[d]=a[c],a[c]=b;return a};return f.init=i,f});