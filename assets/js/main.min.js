!function(a,b,c,d,e){a.GuessWhere=a.GuessWhere||e(a,b,c,d),c(b).ready(GuessWhere.init)}(this,document,jQuery,google,function(a,b,c,d){"use strict";function e(b,e,f,g){var h=r.map=new d.maps.Map(r.canvas,{center:new d.maps.LatLng(b||45.436,e||4.876),zoom:f||2,backgroundColor:"#f1f1f1",disableDefaultUI:!0,disableDoubleClickZoom:!0,keyboardShortcuts:!1,scrollwheel:!1,draggable:!1});d.maps.event.addListenerOnce(h,"tilesloaded",function(){return!(!g||"function"!=typeof g)&&g.call(this,h)}),c(a).on("resize",function(a){d.maps.event.trigger(r.map,"resize")})}function f(a,b,d,e){return c.ajax({url:a,type:"GET",dataType:"JSON",data:b,success:d,error:e})}function g(a,b){return r.modes&&r.modes[b]?void a.setOptions({styles:r.modes[b]}):f("./assets/js/modes/"+b+".json",{},function(c){r.modes=r.modes||{},r.modes[b]=c,a.setOptions({styles:c})},function(a,b){})}function h(){r.canvas=c("#mapCanvas").get(0),r.geocoder=new d.maps.Geocoder,e(45.436,4.876,2,function(a){f("./assets/js/countries.json",{},j,function(a,b){}),g(a,"pro"),c(".mode-btn").on("click",function(b){var d=c(this);d.hasClass("mode-active")||(d.addClass("mode-active"),d.siblings().removeClass("mode-active"),g(a,d.data("level")))})}),c(".fa-info-circle").on("click",function(a){alert("By continue to use this website, you agree to use of cookies.")})}function i(a,b){a.push({name:b.name.common,latlng:new d.maps.LatLng(b.latlng[0],b.latlng[1]),capital:b.capital})}function j(a){var b={total:a.length,countries:[],capitals:[],byRegion:{},bySubregion:{}};return c.map(a,function(a){a.capital&&""!==a.capital&&(b.capitals.push(a.capital),i(b.countries,a),b.byRegion[a.region]=b.byRegion[a.region]||[],i(b.byRegion[a.region],a),b.bySubregion[a.subregion]=b.bySubregion[a.subregion]||[],i(b.bySubregion[a.subregion],a))}),r.data=b,k(),n()}function k(){var a=c(".regions"),b=c(".toggle-regions");for(var d in r.data.byRegion)""!=d&&c("<li />").append(c("<label />",{html:" "+d}).prepend(c("<input />",{type:"radio",name:"region",value:d.toLowerCase(),id:"region"+d.replace(" ",""),"data-title":d}).on("click",l))).appendTo(a);b.on("click",function(c){c.preventDefault(),a.toggleClass("regions--open"),b.find(".fa").toggleClass("fa-plus fa-minus")}),c("#regionWorld").click(l)}function l(a){if(this.checked)return r.quiz.region=c(this).data("title"),c(".selected-region").text(r.quiz.region),n()}function m(a,b){a.push(c("<button />",{class:"btn the-guess btn-info animated",type:"button",html:b.capital+'<div class="guess-country">'+b.name+"</div>"}))}function n(){r.quiz=r.quiz||{},r.quiz.done=r.quiz.done||[],r.quiz.correct=r.quiz.correct||0,r.quiz.answer=r.quiz.answer||"",r.quiz.region=r.quiz.region||"World";var a=p();if(void 0===a||!a.capital||""===a.capital)return n();r.geocoder.geocode({address:a.capital},function(b,e){if(e===d.maps.GeocoderStatus.OK){var f=b[0];r.map.panTo(f.geometry.location),r.map.setZoom(s.iOS||s.android?10:12),s.iOS||s.android?r.map.panBy(0,-100):r.map.panBy(-100,0);var g=c(".guesses").empty(),h=[];m(h,a),r.quiz.answer=a.capital+a.name,r.quiz.done.push(a);for(var i=0;i<3;i++){var j=p();void 0!==j&&j.capital?m(h,j):i--}h=q(h),c(h).each(function(a,b){c(b).delay(100*a).promise().done(function(){c(this).appendTo(g).addClass("fadeInLeft").on("click",o)})}),c(".score-out-of").html(r.quiz.done.length)}})}function o(b){b.preventDefault();var d=c(this).prop("disabled",!0),e=d.html();d.text()===r.quiz.answer?(r.quiz.correct+=1,d.toggleClass("btn-info btn-success").html('<i class="fa fa-check"></i> '+e)):(d.toggleClass("btn-info btn-danger").html('<i class="fa fa-remove"></i> '+e),d.siblings(".the-guess").each(function(a,b){var d=c(b),e=d.text(),f=d.html();e===r.quiz.answer&&d.toggleClass("btn-info btn-success").html('<i class="fa fa-check"></i> '+f)})),d.siblings().prop("disabled",!0),c(".scored").html(r.quiz.correct),c(".score-out-of").html(r.quiz.done.length),a.setTimeout(function(){c(".animated").each(function(a,b){c(b).addClass("fadeOutRight")}),n()},1500)}function p(){var a="World"===r.quiz.region?r.data.countries[Math.floor(Math.random()*r.data.countries.length)]:r.data.byRegion[r.quiz.region][Math.floor(Math.random()*r.data.byRegion[r.quiz.region].length)];if(r.quiz&&r.quiz.done&&-1===r.quiz.done.indexOf(a))return a;p()}function q(a){for(var b,c,d=a.length;d>0;)c=Math.floor(Math.random()*d),d--,b=a[d],a[d]=a[c],a[c]=b;return a}var r={},s={fbscopes:"email",iOS:new RegExp(/iP(od|ad|hone)/).test(navigator.userAgent),android:new RegExp(/(Android)/).test(navigator.userAgent)};return s.init=h,s});